

    


    


    


    


<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta charset="utf-8" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Pylons система плагинов для своего проекта (yapsy) &mdash; Ural penguins</title>
    

    
        <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    

    
        
    
            <link rel="index" title="Алфавитный указатель" href="../../../genindex/"/>
            <link rel="search" title="Поиск" href="../../../search/"/>

        <link rel="top" title="Ural penguins" href="../../../"/>

    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800,300&subset=latin,cyrillic,cyrillic-ext" rel="stylesheet" type="text/css" />

    <link href="../../../_static/css/badge_only.css" type="text/css" rel="stylesheet" />
    <link href="../../../_static/css/__theme.css" type="text/css" rel="stylesheet" />

    
            <script type="text/javascript" src="../../../_static/jquery.js"></script>
            <script type="text/javascript" src="../../../_static/underscore.js"></script>
            <script type="text/javascript" src="../../../_static/doctools.js"></script>
            <script type="text/javascript" src="../../../_static/metrika.js"></script>
            <script type="text/javascript" src="../../../_static/translations.js"></script>
    
  
  <style type="text/css">
    html, body {
      background: #545d5c !important;
    }
    .page__left .menu {
        width: 0px;
    }
    .page__right {
      background-color: #e7e7e7;
      margin: 0 0 0 30px;
    }
    .rst-content {
      padding: 13px;
    }
    .footer {
      padding: 13px;
    }
    /* unvisited link */
    ul.postlist-style-none a:link, .head a:link {
        color: #222;
        text-decoration: none;
    }

    /* visited link */
    ul.postlist-style-none a:visited, .head a:visited {
        color: #222;
        text-decoration: none;
    }

    /* mouse over link */
    ul.postlist-style-none a:hover, .head a:hover {
        color: #222;
        text-decoration: none;
    }

    ul.postlist-style-none a:active, .head a:active {
        color: #222;
        text-decoration: none;
    }
    ul.postlist-style-none li {
        list-style-type: none;
    }
    ul.postlist-style-none li p.first {
      color: red !important;
      font: 1.8em "Open Sans",Arial,sans-serif !important;
    }
    .first a {
      font-weight: bold;
    }
    .first em {
      font-style: normal !important;
    }
    .wrapper__inner {
      padding: 0px 30px 0 0 !important;
    }
    .strike {
      text-decoration: line-through;
    }
  </style>

  
  
  <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.post-list-style-disc {list-style-type: disc;}
    ul.post-list-style-none {list-style-type: none;}
    ul.post-list-style-circle {list-style-type: circle;}
  </style>

</head>

<body>
    <div class="wrapper">
        <div class="wrapper__inner">
            <div class="page
                ">
                <div class="page__left">
                  
                    <nav class="menu" id="menu" data-state="expand">
                        <div class="menu-inner">
                            
                                <div class="menu-project">
                                    <a href="../../../" class="menu-project__link">Ural penguins</a>
                                </div>
                            
                            <div class="tree">
                                
                                
                                    <ul>
<li><a class="reference internal" href="#">Pylons система плагинов для своего проекта (yapsy)</a></li>
</ul>

                                
                            </div>
                            <div class="menu-search search">
                                <div class="search-title">Quick search</div>
                                <form id="search-form" class="search-form" action="../../../search/" method="GET">
                                    <input type="text" name="q" placeholder="Search docs" />
                                    <input type="hidden" name="check_keywords" value="yes" />
                                    <input type="hidden" name="area" value="default" />
                                </form>
                                <div class="search-desc">Enter search terms or a module, class or function name.</div>
                            </div>
                            <nav class="wy-nav-side">&nbsp;</nav>
                        </div>
                        <div class="menu-switch">
                            <div class="menu-switch__arrow">«</div>
                        </div>
                    </nav>
                  
                </div>

                <section class="page__right">
                    
  <div class="head" style="background-image: url('/_static/bg.jpg');
                  background-size: 100%;
                  background-repeat: no-repeat;
                  height: 200px">
    <a href="/">
      <div style="width:100%; height: 75%">
        <h1 style="padding-top:15px;padding-left:15px;font-size:60px">Ural penguins</h1>
      </div>
    </a>
    <table style="
        border-collapse: unset !important;
        border-spacing: 1 !important;">
        <tr>
            <td style="padding-right: 2px">
                <a href="/pages/pyramid/index.html">
                    <div style="background: white;width:100px;height:50px;line-height:50px;text-align:center;"
                        onmouseover="this.style.background='lightgrey';" onmouseout="this.style.background='white';">
                        Pyramid
                    </div>
                </a>
            </td>
            <td>
                <a href="/pages/nixos/index.html">
                    <div style="background: white;width:100px;height:50px;line-height:50px;text-align:center;"
                        onmouseover="this.style.background='lightgrey';" onmouseout="this.style.background='white';">
                        NixOS
                    </div>
                </a>
            </td>
        </tr>
    </table>
  </div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <div class="badge" style="width:100%;height:80px">
    <!-- uralbash.ru -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-2884502571619359"
         data-ad-slot="9876011339"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    </div>

                    <div class="badge">
                        
                        
                    </div>

                    <div class="rst-content">
                        
  <script type="text/javascript" src="//yastatic.net/share/share.js" charset="utf-8"></script>
  <table>
    <tr>
      <td>
        <div class="yashare-auto-init" data-yashareL10n="ru"
          data-yashareType="medium"
          data-yashareQuickServices="vkontakte,facebook,twitter,odnoklassniki,moimir,gplus"
          data-yashareTheme="counter"></div>
      </td>
      <td>
        
  
  
    
      <div style="fint-size: 14pt;padding-left: 10pt;display:inline;">
        Feb 27, 2012
      </div>
    
    
      <div style="fint-size: 14pt;padding-left: 10pt;display:inline;">
      
        
          <i class="fa-fw fa fa-tags"></i>
        
        
      
        
        <a href="../../../blog/tag/python/">Python</a>,
        
      
        
        <a href="../../../blog/tag/pylons/">Pylons</a>,
        
      
        
        <a href="../../../blog/tag/yapsy/">yapsy</a>
        
      
      </div>
    

      </td>
    </tr>
  </table>
  <div class="section" id="pylons-yapsy">
<h1>Pylons система плагинов для своего проекта (<a class="reference external" href="https://pypi.python.org/pypi/yapsy">yapsy</a>)<a class="headerlink" href="#pylons-yapsy" title="Ссылка на этот заголовок">¶</a></h1>
<p>При проектировании любого проекта, через определенное время, встает проблема
маштабируемости, конечно если вы не пишите сайт-визитку или что то подобное.
Проект может состоять из одного большого монолитного ядра с множеством
контроллеров, сотнями или даже тысячами таблиц и бессчетным количеством разных
шаблонов, библиотек итд итп. Под ядром подразумевается та часть проекта
(<a class="reference external" href="http://docs.pylonsproject.org/projects/pylons-webframework/en/latest/">pylons</a>), которую либо нельзя изменить совсем, либо это потребует очень
больших усилий. Для того что бы создать гибкий и легко масштабируемый веб (и не
только) проект, необходимо иметь небольшое ядро, которое будет выполнять
минимальный функционал соответствующий логически завершенной программе.
Остальные функции, пусть даже улучшающие программу, нужно выносить за пределы
ядра. Вообще я знаю только два способа решения этой проблемы:</p>
<ul class="simple">
<li>это создание API;</li>
<li>создание подключаемых модулей(плагинов).</li>
</ul>
<p>В этой статье рассмотрим систему плагинов. Для работы понадобится очень
неплохая библиотека <a class="reference external" href="https://pypi.python.org/pypi/yapsy">yapsy</a> и любой проект на <a class="reference external" href="http://docs.pylonsproject.org/projects/pylons-webframework/en/latest/">pylons</a> (по аналогии
можно реализовать это например в <a class="reference external" href="https://www.djangoproject.com/">Django</a> или <a class="reference external" href="https://pypi.python.org/pypi/web.py">web.py</a> или ... bla bla bla).</p>
<p>Добавим в проект папку откуда будут браться плагины:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>.
   ├── config
   ├── controllers
   ├── forms
   ├── lib
   ├── model
   ├── plugins
   ├── public
   ├── tasks
   ├── templates
   └── tests
</pre></div>
</div>
<p>Добавим пару плагинов в папку <code class="docutils literal"><span class="pre">plugins</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>.
├── autoloads
│   ├── inline
│   │   └── osmMap
│   │   ├── osm_map.py
│   │   └── osm_map.yapsy-plugin
│   └── menu
│   └── about
│   ├── about.py
│   └── about.yapsy-plugin
├── categories
│   ├── __init__.py
│   ├── inline.py
│   └── menu.py
└── __init__.py
</pre></div>
</div>
<p>Из директорий видно что мы создали два типа плагинов <code class="docutils literal"><span class="pre">inline</span></code> и <code class="docutils literal"><span class="pre">menu</span></code>.
<code class="docutils literal"><span class="pre">Inline</span></code> это плагины встраиваемые на страницу, <code class="docutils literal"><span class="pre">menu</span></code> это дополнительные
пункты в меню. Папки и категории можно формировать как угодно и в любой
вложенности. Сами плагины должны иметь ОБЯЗАТЕЛЬНО файл с таким же именем и
расширением <code class="docutils literal"><span class="pre">yapsy-plugin</span></code>. В нашем случае <code class="docutils literal"><span class="pre">osm-map</span></code> выводит
<a class="reference external" href="http://www.openstreetmap.org">OpenStreetMap</a> карту, а <code class="docutils literal"><span class="pre">about</span></code> добавляет в меню новый пункт. Дальше я
бегло опишу то что у меня получилось, а посмотреть код можно здесь
<a class="reference external" href="https://github.com/uralbash/pylons_yapsy_plugin">https://github.com/uralbash/pylons_yapsy_plugin</a>. Думаю не имеет смысла
описывать все подробно, т.к. в коде много комментариев.</p>
<p>После старта проекта Вы увидите окно с картой и меню <code class="docutils literal"><span class="pre">&quot;about&quot;</span></code>. Наши плагины
автоматически подгрузились.</p>
<div class="figure align-center" id="id1">
<img alt="../../../_images/osm_yapsy.png" src="../../../_images/osm_yapsy.png" />
<p class="caption"><span class="caption-text">yapsy plugin example</span></p>
</div>
<p>Теперь перейдем на вкладку <code class="docutils literal"><span class="pre">&quot;plugin&quot;</span></code> и отключим <a class="reference external" href="http://www.openstreetmap.org">OpenStreetMap</a>:</p>
<div class="figure align-center" id="id2">
<img alt="../../../_images/osm_yapsy2.png" src="../../../_images/osm_yapsy2.png" />
<p class="caption"><span class="caption-text">yapsy plugin deactivate</span></p>
</div>
<p>Заходим во вкладку <code class="docutils literal"><span class="pre">&quot;home&quot;</span></code>:</p>
<div class="figure align-center" id="id3">
<img alt="../../../_images/osm_yapsy3.png" src="../../../_images/osm_yapsy3.png" />
<p class="caption"><span class="caption-text">yapsy plugin deactivated</span></p>
</div>
<p>И &#8220;О черт Дэвид Блэйн! Верни ее на место!!!&#8221;.</p>
<p>То же самое с меню при отключении оно пропадет. Отключенные плагины хранятся в
БД в таблице <code class="docutils literal"><span class="pre">DeactivatedPlugins</span></code>.</p>
<p>P.S.: Для чего это нужно еще раз? Для того например если руководство решило
убрать из программы карту <a class="reference external" href="http://www.openstreetmap.org">OpenStreetMap</a> немедленно. Вы тут же бросились
это все выпиливать... да? А через неделю руководство вдруг решило что нужна
карта! Вы начинаете ее запиливать обратно итд итп. Мне например проще нажать
одну кнопку, чем переписывать MVC. В этом и есть гибкость. Пользуйтесь.</p>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  
  <a href="../ajax_triple_select/">
    <i class="fa fa-arrow-circle-left"></i>
    AJAX тройной выпадающий список (triple select)
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  
  <a href="../matplotlib_numpy_and_virtualenv/">
    Установка Matplotlib и Numpy в virtualenv на Debian
    <i class="fa fa-arrow-circle-right"></i>
  </a>
  </span>
  
</div>

  
  
    <div class="section">
    <br />
    <script type="text/javascript" src="//yastatic.net/share/share.js" charset="utf-8"></script><div class="yashare-auto-init" data-yashareL10n="ru" data-yashareType="medium" data-yashareQuickServices="vkontakte,facebook,twitter,odnoklassniki,moimir,gplus" data-yashareTheme="counter"></div>
    <h2>Comments</h2>

    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'uralbash'; // required: replace example with your forum shortname
        var disqus_identifier = '/articles/2012/pylons_yapsy/';
        var disqus_title = 'Pylons система плагинов для своего проекта (yapsy)';
        
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

                    </div>
                    <footer class="footer">
                      
  
                        
    <div class="footer__copyright">
            
                &copy; Copyright 2015, uralbash.
            
    </div>
<div class="footer__theme">
    <a href="https://github.com/ITCase/itcase_sphinx_theme" class="footer__theme-link">
      ITCase Sphinx Theme
    </a>
      <span class="footer__theme-text">
          | version: 0.2.0
      </span>
</div>
                      
  <div class="footer__theme">
      <a href="https://github.com/abakan/ablog" class="footer__theme-link">
        Ablog powered.
      </a>
  </div>
  <div class="footer__theme">
      <a href="http://uralbash.ru/blog/atom.xml" class="footer__theme-link">
        RSS/Atom
      </a>
  </div>
  <div class="footer__theme">
      <a href="https://uralbash.blogspot.com" class="footer__theme-link">
        Старый блог
      </a>
  </div>

                    </footer>
                </section>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        
            var STICKY_MENU = true;
        
    </script>

    <script type="text/javascript" src="../../../_static/js/__theme.js"></script>

    
        <script type="text/javascript">
            var DOCUMENTATION_OPTIONS = {
                    URL_ROOT: '../../../',
                    VERSION: '',
                    COLLAPSE_INDEX: false,
                    FILE_SUFFIX: '',
                    HAS_SOURCE: true
            };
        </script>
    

    
</body>
</html>