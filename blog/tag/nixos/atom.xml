<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Ural penguins - Сообщения с тегом NixOS</title>
  <id>http://uralbash.ru/blog/tag/nixos/atom.xml</id>
  <updated>2017-08-28T19:33:00Z</updated>
  <link href="http://uralbash.ru/" />
  <link href="http://uralbash.ru/blog/tag/nixos/atom.xml" rel="self" />
  <generator uri="http://ablog.readthedocs.org" version="0.8.4">ABlog</generator>
  <entry xml:base="http://uralbash.ru/blog/tag/nixos/atom.xml">
    <title type="text">Сборка пакета для Nix</title>
    <id>http://uralbash.ru/articles/2017/nixpkgs-contribute/</id>
    <updated>2017-08-28T19:33:00Z</updated>
    <published>2017-08-28T19:33:00Z</published>
    <link href="http://uralbash.ru/articles/2017/nixpkgs-contribute/" />
    <author>
      <name>Uralbash</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;nix&quot;&gt;

&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixpkgs/&quot;&gt;Nix&lt;/a&gt; - замечательный пакетный менеджер, который
работает на &lt;cite&gt;MacOS&lt;/cite&gt; и любом дистрибутиве &lt;cite&gt;Linux&lt;/cite&gt;, причем из-за своей
функциональной чистоты и изоляции зависимостей, гарантировано выдает всегда
одинаковый результат.&lt;/p&gt;
&lt;p&gt;На сегодняшний день &lt;cite&gt;Nix&lt;/cite&gt; имеет огромную базу пакетов, которая ежедневно
пополняется. Для сборки своего пакета потребуется знание языка &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/manual/#chap-writing-nix-expressions&quot;&gt;Nix
expression&lt;/a&gt;. Это
чистый функциональный язык созданный специально для пакетного менеджера &lt;cite&gt;Nix&lt;/cite&gt; и
операционной системы &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;Примечание&lt;/p&gt;
&lt;ul class=&quot;last simple&quot;&gt;
&lt;li&gt;Ресурсы по &lt;a class=&quot;reference internal&quot; href=&quot;../../../pages/nixos/#nixos&quot;&gt;&lt;span class=&quot;std std-ref&quot;&gt;NixOS&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Статьи &lt;a class=&quot;reference external&quot; href=&quot;http://uralbash.ru/blog/tag/nix/&quot;&gt;http://uralbash.ru/blog/tag/nix/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;Для примера создадим сборку пакета языка программирования &lt;a class=&quot;reference external&quot; href=&quot;http://www.red-lang.org/&quot;&gt;Red&lt;/a&gt;. Будем следовать оф. документации
&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixpkgs/manual/#chap-quick-start&quot;&gt;https://nixos.org/nixpkgs/manual/#chap-quick-start&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;section&quot; id=&quot;id2&quot;&gt;
&lt;h2&gt;1. Скачиваем исходники&lt;/h2&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ git clone git://github.com/NixOS/nixpkgs.git
$ &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; nixpkgs
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id3&quot;&gt;
&lt;h2&gt;2. Добавляем директорию с новым пакетом&lt;/h2&gt;
&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;p class=&quot;last&quot;&gt;Правила именования файлов
&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixpkgs/manual/#sec-organisation&quot;&gt;https://nixos.org/nixpkgs/manual/#sec-organisation&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ mkdir pkgs/development/interpreters/red/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;default-nix&quot;&gt;
&lt;h2&gt;3. Создаем файл описания пакета &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;default.nix&lt;/span&gt;&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Заготовка для нашего пакета будет выглядеть так:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;table class=&quot;highlighttable&quot;&gt;&lt;tr&gt;&lt;td class=&quot;linenos&quot;&gt;&lt;div class=&quot;linenodiv&quot;&gt;&lt;pre&gt; 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32&lt;/pre&gt;&lt;/div&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; stdenv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchFromGitHub &lt;span class=&quot;p&quot;&gt;}:&lt;/span&gt;

stdenv&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;mkDerivation &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;src =&lt;/span&gt; fetchFromGitHub &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;rev =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;6a43c767fa2e85d668b83f749158a18e62c30f70&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;owner =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;repo =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;sha256 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1zh6xc728bs7r4v5jz1jjrdk0xd838xsxmvy9gfg75a3zffm0slr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;configurePhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;buildPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;installPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;meta =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; stdenv&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;lib&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;description =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      New programming language strongly inspired by Rebol, but with a&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      broader field of usage thanks to its native-code compiler, from system&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      programming to high-level scripting, while providing modern support for&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      concurrency and multi-core CPUs&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;maintainers =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; maintainers&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; uralbash &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;platforms =&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;i686-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;x86_64-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;license =&lt;/span&gt; licenses&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;bsd3&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;homepage =&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;http://www.red-lang.org/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;
&lt;p&gt;В первой строке указан импорт необходимых нам функций.&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; stdenv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchFromGitHub &lt;span class=&quot;p&quot;&gt;}:&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Далее забираем исходники с &lt;cite&gt;GitHub&lt;/cite&gt; при помощи функции &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;fetchFromGitHub&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;src =&lt;/span&gt; fetchFromGitHub &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;rev =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;6a43c767fa2e85d668b83f749158a18e62c30f70&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;owner =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;repo =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;sha256 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1zh6xc728bs7r4v5jz1jjrdk0xd838xsxmvy9gfg75a3zffm0slr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Что бы посчитать хэш (sha256) нам потребуется утилита &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-prefetch-git&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-prefetch-git https://github.com/red/red 6a43c767fa2e85d668b83f749158a18e62c30f70
Initialized empty Git repository in /tmp/git-checkout-tmp-Jzca0REG/red-6a43c76/.git/
fatal: Invalid refspec &amp;#39;+refs/tags/v0.6.3^{}&amp;#39;
remote: Counting objects: 52473, done.
remote: Total 52473 (delta 0), reused 0 (delta 0), pack-reused 52473
Receiving objects: 100% (52473/52473), 20.39 MiB | 1.50 MiB/s, done.
Resolving deltas: 100% (35793/35793), done.
From https://github.com/red/red
Switched to a new branch &amp;#39;fetchgit&amp;#39;
removing `.git&amp;#39;...

git revision is 6a43c767fa2e85d668b83f749158a18e62c30f70
path is /nix/store/qp10dy2plvskbv0zjpcg9mmrsszd1a6i-red-6a43c76
git human-readable version is v0.6.3
Commit date is 2017-07-17 21:25:27 +0800
hash is 1zh6xc728bs7r4v5jz1jjrdk0xd838xsxmvy9gfg75a3zffm0slr
{
  &amp;quot;url&amp;quot;: &amp;quot;https://github.com/red/red&amp;quot;,
  &amp;quot;rev&amp;quot;: &amp;quot;6a43c767fa2e85d668b83f749158a18e62c30f70&amp;quot;,
  &amp;quot;date&amp;quot;: &amp;quot;2017-07-17T21:25:27+08:00&amp;quot;,
&lt;span class=&quot;hll&quot;&gt;  &amp;quot;sha256&amp;quot;: &amp;quot;1zh6xc728bs7r4v5jz1jjrdk0xd838xsxmvy9gfg75a3zffm0slr&amp;quot;,
&lt;/span&gt;  &amp;quot;fetchSubmodules&amp;quot;: true
}
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;В конце файла указывается мета информация:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;meta =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; stdenv&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;lib&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;description =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    New programming language strongly inspired by Rebol, but with a&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    broader field of usage thanks to its native-code compiler, from system&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    programming to high-level scripting, while providing modern support for&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    concurrency and multi-core CPUs&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;maintainers =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; maintainers&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; uralbash &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;platforms =&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;i686-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;x86_64-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;license =&lt;/span&gt; licenses&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;bsd3&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;homepage =&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;http://www.red-lang.org/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Сама сборка происходит в 3 директивах &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;configurePhase&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;buildPhase&lt;/span&gt;&lt;/code&gt;,
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;installPhase&lt;/span&gt;&lt;/code&gt;. Если их не указывать, то по умолчанию будут выполняться
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;./configure&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;make&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;install&lt;/span&gt;&lt;/code&gt; соответственно. Т.к. &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Red&lt;/span&gt;&lt;/code&gt; не
использует &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;autotools&lt;/span&gt;&lt;/code&gt; для сборки, то нам придется вручную прописать все
необходимые шаги. Что бы не изобретать велосипед возьмем за основу пакет из
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Arch&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;Linux&lt;/span&gt;&lt;/code&gt; &lt;a class=&quot;reference external&quot; href=&quot;https://aur.archlinux.org/cgit/aur.git/tree/PKGBUILD?h=red&quot;&gt;https://aur.archlinux.org/cgit/aur.git/tree/PKGBUILD?h=red&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Red&lt;/span&gt;&lt;/code&gt; требует 32х битный &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;curl&lt;/span&gt;&lt;/code&gt;, добавим его в окружение сборки:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; stdenv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; stdenv_32bit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pkgsi686Linux&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchFromGitHub&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchurl &lt;span class=&quot;p&quot;&gt;}:&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;ss&quot;&gt;buildInputs =&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl stdenv_32bit &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Скачаем &lt;a class=&quot;reference external&quot; href=&quot;http://www.rebol.com/&quot;&gt;Rebol&lt;/a&gt;. При помощи него собирается
интерпретатор &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Red&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;ss&quot;&gt;rebol =&lt;/span&gt; fetchurl &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;url =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://www.rebol.com/downloads/v278/rebol-core-278-4-2.tar.gz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;sha256 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1c1v0pyhf3d8z98qc93a5zmx0bbl0qq5lr8mbkdgygqsq2bv2xbz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;ss&quot;&gt;r2 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./rebol/releases/rebol-core/rebol&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;В нашем случае, что добавлять в фазы установки имеет очень условных характер.
Поделим следующим образом - в фазу конфигурации добавим распаковку &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Rebol&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;configurePhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  # Download rebol&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  mkdir rebol/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  tar -xzvf &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;rebol&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -C rebol/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  patchelf --set-interpreter \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2 \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Заметьте &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;r2&lt;/span&gt;&lt;/code&gt; это переменная, которую мы объявили выше. А &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/patchelf.html&quot;&gt;PatchELF&lt;/a&gt; это мега крутая утилита, которой можно
подменять динамические зависимости в бинарниках, не пересобирая их. Мы изменили
путь до &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;ld-linux.so.2&lt;/span&gt;&lt;/code&gt; файла, т.к. в &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;NixOS&lt;/span&gt;&lt;/code&gt; он имеет нестандартный путь.&lt;/p&gt;
&lt;div class=&quot;admonition note&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;Примечание&lt;/p&gt;
&lt;p class=&quot;last&quot;&gt;При этом если такой пакет собирать в Ubuntu то патчить rebol нет
необходимости, он подхватит зависимость из стандартного пути. Но для
большей универсальности это необходимо.&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;После условной конфигурации приступим к сборке интерпретатора &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Red&lt;/span&gt;&lt;/code&gt;. Все шаги
выполняются относительно директории с исходными кодами с GitHub:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;buildPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  # Do tests&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  #&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw run-all.r&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  # Build test&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw red.r tests/hello.red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  # Compiling the Red console...&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw red.r -r environment/console/console.red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  # Generating docs...&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  cd docs&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  ../&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw makedoc2.r red-system-specs.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  ../&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw makedoc2.r red-system-quick-test.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  cd ../&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Установка:&lt;/p&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;installPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  mkdir $out&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  # Install&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -d $out/opt/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  find quick-test -type f -executable -print0 | xargs -0 rm&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  cp -R * $out/opt/red/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  rm -rf $out/opt/red/rebol&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -Dm755 console $out/bin/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -Dm644 BSD-3-License.txt                          \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/share/licenses/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/BSD-3-License.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -Dm644 BSL-License.txt                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/share/licenses/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/BSL-License.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -Dm644 docs/red-system-quick-test.html            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/share/doc/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/red-system-quick-test.html&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  install -Dm644 docs/red-system-specs.html                 \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/share/doc/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/red-system-specs.html&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  # PathElf&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  patchelf --set-interpreter                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2  \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/opt/red/console&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  patchelf --set-rpath &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/opt/red/console&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  patchelf --set-interpreter                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2  \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/bin/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  patchelf --set-rpath &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      $out/bin/red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id4&quot;&gt;
&lt;h2&gt;4. Добавление в общий список пакетов&lt;/h2&gt;
&lt;p&gt;Почти все готово, осталось добавить новый пакет в общий список и собрать.&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ vim pkgs/top-level/all-packages.nix
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;ss&quot;&gt;rascal =&lt;/span&gt; callPackage &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;l&quot;&gt;/development/interpreters/rascal&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;hll&quot;&gt;&lt;span class=&quot;ss&quot;&gt;red =&lt;/span&gt; callPackage &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;l&quot;&gt;/development/interpreters/red&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/span&gt;
&lt;span class=&quot;ss&quot;&gt;regina =&lt;/span&gt; callPackage &lt;span class=&quot;o&quot;&gt;..&lt;/span&gt;&lt;span class=&quot;l&quot;&gt;/development/interpreters/regina&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id5&quot;&gt;
&lt;h2&gt;5. Сборка&lt;/h2&gt;
&lt;p&gt;Сборка пакета выполняется командой &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-build&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-build -A red
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Или если необходимо его сразу установить в окружение:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-build -f . -iA red
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Полный исходник выглядит так:&lt;/p&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id6&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;default.nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-nix&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; stdenv&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; stdenv_32bit&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; pkgsi686Linux&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchFromGitHub&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; fetchurl &lt;span class=&quot;p&quot;&gt;}:&lt;/span&gt;

stdenv&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;mkDerivation &lt;span class=&quot;k&quot;&gt;rec&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;name =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red-v&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;version&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;version =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0.6.3&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;ss&quot;&gt;src =&lt;/span&gt; fetchFromGitHub &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;rev =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;6a43c767fa2e85d668b83f749158a18e62c30f70&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;owner =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;repo =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;sha256 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1zh6xc728bs7r4v5jz1jjrdk0xd838xsxmvy9gfg75a3zffm0slr&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;rebol =&lt;/span&gt; fetchurl &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;url =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://www.rebol.com/downloads/v278/rebol-core-278-4-2.tar.gz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;sha256 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;1c1v0pyhf3d8z98qc93a5zmx0bbl0qq5lr8mbkdgygqsq2bv2xbz&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;buildInputs =&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl stdenv_32bit &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;r2 =&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./rebol/releases/rebol-core/rebol&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;configurePhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    # Download rebol&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    mkdir rebol/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    tar -xzvf &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;rebol&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -C rebol/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    patchelf --set-interpreter \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2 \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;buildPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    # Do tests&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    #&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw run-all.r&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;    # Build test&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw red.r tests/hello.red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;    # Compiling the Red console...&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw red.r -r environment/console/console.red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;    # Generating docs...&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    cd docs&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    ../&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw makedoc2.r red-system-specs.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    ../&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;r2&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; -qw makedoc2.r red-system-quick-test.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    cd ../&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;installPhase =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    mkdir $out&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;    # Install&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -d $out/opt/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    find quick-test -type f -executable -print0 | xargs -0 rm&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    cp -R * $out/opt/red/&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    rm -rf $out/opt/red/rebol&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -Dm755 console $out/bin/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -Dm644 BSD-3-License.txt                          \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/share/licenses/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/BSD-3-License.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -Dm644 BSL-License.txt                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/share/licenses/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/BSL-License.txt&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -Dm644 docs/red-system-quick-test.html            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/share/doc/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/red-system-quick-test.html&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    install -Dm644 docs/red-system-specs.html                 \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/share/doc/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;name&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/red-system-specs.html&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;    # PathElf&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    patchelf --set-interpreter                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2  \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/opt/red/console&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    patchelf --set-rpath &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/opt/red/console&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    patchelf --set-interpreter                            \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;stdenv_32bit&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;cc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;libc&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib/32/ld-linux.so.2  \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/bin/red&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    patchelf --set-rpath &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;pkgsi686Linux&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;curl&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;out&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/lib \&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;        $out/bin/red&lt;/span&gt;

&lt;span class=&quot;s1&quot;&gt;  &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;ss&quot;&gt;meta =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; stdenv&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;lib&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;description =&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      New programming language strongly inspired by Rebol, but with a&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      broader field of usage thanks to its native-code compiler, from system&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      programming to high-level scripting, while providing modern support for&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;      concurrency and multi-core CPUs&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;    &amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;maintainers =&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; maintainers&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; uralbash &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;platforms =&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;i686-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;x86_64-linux&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;license =&lt;/span&gt; licenses&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;bsd3&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;ss&quot;&gt;homepage =&lt;/span&gt; &lt;span class=&quot;l&quot;&gt;http://www.red-lang.org/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Готовый пакет можно отправить в основную ветку &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nixpkgs&lt;/span&gt;&lt;/code&gt;. Перед этим лучше
почитать как правильно делать &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;pull&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;request&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixpkgs/manual/#idm140737317358720&quot;&gt;https://nixos.org/nixpkgs/manual/#idm140737317358720&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixpkgs/manual/#sec-reviewing-contributions&quot;&gt;https://nixos.org/nixpkgs/manual/#sec-reviewing-contributions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;В следующей статье я постараюсь описать как собирать свой собственный &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;NixOS&lt;/span&gt;&lt;/code&gt;
дистрибутив с шахматами и балеринами.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="http://uralbash.ru/blog/tag/nixos/atom.xml">
    <title type="text">Пакетный менеджер Nix</title>
    <id>http://uralbash.ru/articles/2016/nixpkgs/</id>
    <updated>2016-07-06T22:24:00Z</updated>
    <published>2016-07-06T22:24:00Z</published>
    <link href="http://uralbash.ru/articles/2016/nixpkgs/" />
    <author>
      <name>Uralbash</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;nix&quot;&gt;

&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;p class=&quot;last&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://nixos.org/nix/&quot;&gt;http://nixos.org/nix/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;Nix&lt;/a&gt; - пакетный менеджер, который устанавливает пакеты изолированно друг от
друга. Изначально появился в процессе научной работы &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/~eelco/&quot;&gt;Eelco Dolstra&lt;/a&gt; и позже обрел огромную популярность и сторонников
данной идеи, что в итоге сформировало очень активное сообщество, ссылки на
которое можно найти здесь &lt;a class=&quot;reference internal&quot; href=&quot;../../../pages/nixos/#nixos&quot;&gt;&lt;span class=&quot;std std-ref&quot;&gt;NixOS&lt;/span&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;p class=&quot;last&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://rhodecode.com/blog/61/rhodecode-and-nix-package-manager&quot;&gt;https://rhodecode.com/blog/61/rhodecode-and-nix-package-manager&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;Nix&lt;/a&gt; в отличии от других UNIX дистрибутивов устанавливает пакеты всегда в
одно и то же место &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;/nix/store/&lt;/span&gt;&lt;/code&gt;. Внутри каждого пакета создается необходимая
структура директорий &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;bin&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;etc&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;lib&lt;/span&gt;&lt;/code&gt;, и прочее. Пользователь видит
это все у себя за счет симлинков, которые прописываются при установке, см.
рисунок:&lt;/p&gt;
&lt;img alt=&quot;_static/2016/nix_fs.png&quot; src=&quot;_static/2016/nix_fs.png&quot; /&gt;
&lt;p&gt;Это позволяет избежать конфликта имен, при установке пакетов и иметь в системе
несколько версий одной и той же программы собранной по разному.&lt;/p&gt;
&lt;p&gt;Отличительной особенностью &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;nix&lt;/a&gt;, является то, что он не зависит от
дистрибутива. Единственным требованием является поддержка &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;POSIX&lt;/span&gt;&lt;/code&gt; потоков и
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;C++&lt;/span&gt;&lt;/code&gt; компилятор. Все пакеты из реп запускаются, без проблем, на любом Linux
дистрибутиве и многие платформонезависимые пакеты работают в &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;MacOS&lt;/span&gt;&lt;/code&gt;. Есть
инструкции как установить &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;nix&lt;/a&gt; в &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Cygwin&lt;/span&gt;&lt;/code&gt; под &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Windows&lt;/span&gt;&lt;/code&gt;. Я пользуюсь
&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;nix&lt;/a&gt; под &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;CentOS6&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;CentOS7&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Ubuntu&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;NixOS&lt;/span&gt;&lt;/code&gt; и это работает
везде одинаково хорошо.&lt;/p&gt;
&lt;p&gt;Из плюсов можно отметить:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;везде одинаковый интерфейс, не нужно запоминать как работает &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;yum&lt;/span&gt;&lt;/code&gt;,
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;apt&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;apk&lt;/span&gt;&lt;/code&gt;, ...&lt;/li&gt;
&lt;li&gt;одна репа для всех дистрибутивов, везде одинаковые версии программ&lt;/li&gt;
&lt;li&gt;репа на гитхабе, это очень удобно (&lt;a class=&quot;reference external&quot; href=&quot;https://github.com/NixOS/nixpkgs&quot;&gt;https://github.com/NixOS/nixpkgs&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;изолированная установка, новый пакет не может сломать остальные&lt;/li&gt;
&lt;li&gt;возможность установки нескольких версий одного пакета, например &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;glibc&lt;/span&gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;транзакционность - развитая модель откатки состояния&lt;/li&gt;
&lt;li&gt;огромное количество пакетов, самых свежих версий&lt;/li&gt;
&lt;li&gt;хранит все в одной директории &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;/nix&lt;/span&gt;&lt;/code&gt;, не захламляет систему, удаляется
одной командой &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;-rf&lt;/span&gt; &lt;span class=&quot;pre&quot;&gt;/nix&lt;/span&gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Из минусов:&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;чуть больший размер пакетов, из-за того что могут использоваться разные
версии одной и той же зависимости в разных пакетах&lt;/li&gt;
&lt;li&gt;сервисы и демоны устанавливаются в виде бинарников, прописывать их в
автозапуск и систему инициализации придется вручную. Это не относится к
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;NixOS&lt;/span&gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;section&quot; id=&quot;id1&quot;&gt;
&lt;h2&gt;Установка&lt;/h2&gt;
&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;p class=&quot;last&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://nixos.org/nix/manual/#ch-installing-binary&quot;&gt;http://nixos.org/nix/manual/#ch-installing-binary&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Установка крайне простая, делается одной командой:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ curl https://nixos.org/nix/install &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; sh
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id2&quot;&gt;
&lt;h2&gt;Команды&lt;/h2&gt;
&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;ul class=&quot;last simple&quot;&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/wiki/Cheatsheet&quot;&gt;https://nixos.org/wiki/Cheatsheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://nixos.org/nix/manual/#chap-package-management&quot;&gt;http://nixos.org/nix/manual/#chap-package-management&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt; удивительный проект с очень хорошей документацией и большим
мега-активным сообществом (&lt;a class=&quot;reference internal&quot; href=&quot;../../../pages/nixos/#nixos&quot;&gt;&lt;span class=&quot;std std-ref&quot;&gt;NixOS&lt;/span&gt;&lt;/a&gt;). Поэтому нет смысла дублировать
документацию, опишу лишь некоторые команды в сравнении с пакетным менеджером
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;apt&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;section&quot; id=&quot;id3&quot;&gt;
&lt;h3&gt;Установка пакетов:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id10&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get install firefox python vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id11&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-env -i firefox python vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id4&quot;&gt;
&lt;h3&gt;Удаление:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id12&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get remove python
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id13&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-env -e python
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id5&quot;&gt;
&lt;h3&gt;Обновление реп:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id14&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get update
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id15&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-channel --update
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id6&quot;&gt;
&lt;h3&gt;Обновление пакетов:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id16&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ sudo apt-get upgrade
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id17&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-env -u
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id7&quot;&gt;
&lt;h3&gt;Информация о пакете:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id18&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ apt-cache search vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id19&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-env -qaP &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id8&quot;&gt;
&lt;h3&gt;Описание пакета:&lt;/h3&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id20&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;apt&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ apt-cache show vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id21&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;nix&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-env -qaP --description &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep vim
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;nix-shell&quot;&gt;
&lt;h2&gt;nix-shell&lt;/h2&gt;
&lt;div class=&quot;admonition seealso&quot;&gt;
&lt;p class=&quot;first admonition-title&quot;&gt;См.также&lt;/p&gt;
&lt;ul class=&quot;last simple&quot;&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://nixos.org/nix/manual/#sec-nix-shell&quot;&gt;http://nixos.org/nix/manual/#sec-nix-shell&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://habrahabr.ru/post/281611/&quot;&gt;Nix как менеджер зависимостей для C++&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt; создает изолированное окружение (наподобие &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;virtualenv&lt;/span&gt;&lt;/code&gt; в
питоне) и позволяет запускать в нем команды или выполнять &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix&lt;/span&gt;&lt;/code&gt; скрипты.&lt;/p&gt;
&lt;p&gt;Пример как создать окружение с &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nodejs&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;python3&lt;/span&gt;&lt;/code&gt; и &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;gnumake&lt;/span&gt;&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ nix-shell -p nodejs python3 gnumake
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;После этого &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nodejs&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;python3&lt;/span&gt;&lt;/code&gt; и &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;gnumake&lt;/span&gt;&lt;/code&gt; появятся в нашем окружении.
Выйти из окружения можно так-же как и из bash оболочки &lt;code class=&quot;kbd docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Ctrl&lt;/span&gt;&lt;/code&gt; + &lt;code class=&quot;kbd docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;D&lt;/span&gt;&lt;/code&gt;
или командой &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;exit&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Понять что мы находимся в &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt; сессии можно при помощи переменной
окружения:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ env &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; grep IN_NIX_SHELL
&lt;span class=&quot;nv&quot;&gt;IN_NIX_SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Я добавил отображение символа снежинки &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;❄&lt;/span&gt;&lt;/code&gt; в &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;PS1&lt;/span&gt;&lt;/code&gt;, если &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt;
сессия активна.&lt;/p&gt;
&lt;img alt=&quot;_static/2016/nix_shell.png&quot; src=&quot;_static/2016/nix_shell.png&quot; /&gt;
&lt;p&gt;Очень удобно создавать окружение для скриптов через shebang:&lt;/p&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id22&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;shebang создает окружение для python2 и запускает в нем скрипт&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-python&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#! /usr/bin/env nix-shell&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;#! nix-shell -i python -p python pythonPackages.prettytable&lt;/span&gt;

 &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;prettytable&lt;/span&gt;

 &lt;span class=&quot;c1&quot;&gt;# Print a simple table.&lt;/span&gt;
 &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prettytable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PrettyTable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;N&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;N^2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_row&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;literal-block-wrapper docutils container&quot; id=&quot;id23&quot;&gt;
&lt;div class=&quot;code-block-caption&quot;&gt;&lt;span class=&quot;caption-text&quot;&gt;shebang создает окружение с утилитой cowsay и запускает в баше скрипт&lt;/span&gt;&lt;/div&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#! /usr/bin/env nix-shell&lt;/span&gt;
 &lt;span class=&quot;c1&quot;&gt;#! nix-shell -i bash -p cowsay&lt;/span&gt;

 cowsay &lt;span class=&quot;s2&quot;&gt;&amp;quot;Превед nix-shell!!!&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;По умолчанию команда &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt; ищет файл &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;default.nix&lt;/span&gt;&lt;/code&gt; в текущей
директории и пытается его выполнить, таким образом мы можем создавать для своих
проектов своеобразное виртуальное окружение, просто положив этот файл в корень
проекта и прописав в нем необходимые пакеты и правила сборки. Такой проект
легко будет развернуть на любой системе. Отличной демонстрацией этого является
проект &lt;a class=&quot;reference external&quot; href=&quot;https://rhodecode.com/&quot;&gt;RhodeCode&lt;/a&gt; (позволяет управлять кодом как &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;GitLab&lt;/span&gt;&lt;/code&gt;, но при этом
может использовать разные системы контроля версий &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;git&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;hg&lt;/span&gt;&lt;/code&gt;, &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;svn&lt;/span&gt;&lt;/code&gt; и
интегрируется с разными треккерами задач вплоть до &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Trello&lt;/span&gt;&lt;/code&gt;), который можно
развернуть у себя за 5 мин при помощи команды &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt;
(&lt;a class=&quot;reference external&quot; href=&quot;https://docs.rhodecode.com/RhodeCode-Enterprise/contributing/dev-setup.html&quot;&gt;https://docs.rhodecode.com/RhodeCode-Enterprise/contributing/dev-setup.html&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Также &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix-shell&lt;/span&gt;&lt;/code&gt; позволяет присваивать имена окружениям и запускать
&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix&lt;/span&gt;&lt;/code&gt; выражения, например что бы собрать приложение изолированно от общих
установленных пакетов.&lt;/p&gt;
&lt;p&gt;Более подробно, что такое язык &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nixexpr&lt;/span&gt;&lt;/code&gt; и как при помощи его собирать
пакеты и даже ОС &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt;, я постараюсь описать в отдельной статье.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;home-user&quot;&gt;
&lt;h2&gt;/home/user Окружение&lt;/h2&gt;
&lt;p&gt;Что бы &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Ubuntu&lt;/span&gt;&lt;/code&gt; знала о наших приложениях нужно прописать симлинк:&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ln -s &lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOME&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;/.nix-profile/share/applications/ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
    &lt;span class=&quot;si&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;HOME&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;/.local/share/applications/
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id9&quot;&gt;
&lt;h2&gt;Резюме&lt;/h2&gt;
&lt;p&gt;Пакетный менеджер &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;Nix&lt;/span&gt;&lt;/code&gt; имеет огромное количество преимуществ, которые
упрощают процессы администрирования, программирования, сборки и тестирования
ПО. Теперь на разных Линуксах все работает одинаково! А в CentOS6 есть gcc6.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
  <entry xml:base="http://uralbash.ru/blog/tag/nixos/atom.xml">
    <title type="text">NixOS</title>
    <id>http://uralbash.ru/pages/nixos/</id>
    <updated>2016-07-06T18:06:00Z</updated>
    <published>2016-07-06T18:06:00Z</published>
    <link href="http://uralbash.ru/pages/nixos/" />
    <author>
      <name>Uralbash</name>
    </author>
    <content type="html">&lt;div class=&quot;section&quot; id=&quot;nixos&quot;&gt;
&lt;span id=&quot;id1&quot;&gt;&lt;/span&gt;
&lt;p&gt;Здесь я буду собирать разные полезные ресурсы по ОС &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt; и пакетному
менеджеру &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/&quot;&gt;nix&lt;/a&gt;. Если вы, что то не нашли пишите в комментах.&lt;/p&gt;
&lt;div class=&quot;section&quot; id=&quot;id2&quot;&gt;
&lt;h2&gt;Оф. ресурсы&lt;/h2&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;Официальный сайт &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;https://nixos.org/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Документация &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixos/manual/&quot;&gt;https://nixos.org/nixos/manual/&lt;/a&gt; и &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nix/manual/&quot;&gt;https://nixos.org/nix/manual/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;dl class=&quot;first docutils&quot;&gt;
&lt;dt&gt;Wiki &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/wiki/Main_Page&quot;&gt;https://nixos.org/wiki/Main_Page&lt;/a&gt; (устарела)&lt;/dt&gt;
&lt;dd&gt;&lt;ul class=&quot;first last&quot;&gt;
&lt;li&gt;Новая Wiki &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.wiki/wiki/Main_Page&quot;&gt;https://nixos.wiki/wiki/Main_Page&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;li&gt;Mail рассылки &lt;a class=&quot;reference external&quot; href=&quot;http://lists.science.uu.nl/mailman/listinfo/nix-dev&quot;&gt;http://lists.science.uu.nl/mailman/listinfo/nix-dev&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Код &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/NixOS/nixpkgs/&quot;&gt;https://github.com/NixOS/nixpkgs/&lt;/a&gt; и &lt;a class=&quot;reference external&quot; href=&quot;https://github.com/NixOS/nix/&quot;&gt;https://github.com/NixOS/nix/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Донэйт &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/nixos/foundation.html&quot;&gt;https://nixos.org/nixos/foundation.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Еженедельная рассылка: &lt;a class=&quot;reference external&quot; href=&quot;http://weekly.nixos.org/&quot;&gt;http://weekly.nixos.org/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id3&quot;&gt;
&lt;h2&gt;Полезные ссылки&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://nixcloud.io/tour/&quot;&gt;https://nixcloud.io/tour/&lt;/a&gt; - восхитительный курс по языку &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://learnxinyminutes.com/docs/nix/&quot;&gt;https://learnxinyminutes.com/docs/nix/&lt;/a&gt; - учим синтаксис языка &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://medium.com/&amp;#64;MrJamesFisher/nix-by-example-a0063a1a4c55&quot;&gt;https://medium.com/&amp;#64;MrJamesFisher/nix-by-example-a0063a1a4c55&lt;/a&gt;  - еще про язык &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nix&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://nixpaste.lbr.uno/&quot;&gt;http://nixpaste.lbr.uno/&lt;/a&gt; - сервис на подобии &lt;cite&gt;pastebin&lt;/cite&gt;, но есть подсветка
синтаксиса &lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;nixexpr&lt;/span&gt;&lt;/code&gt; и удобная утилита для командной строки.&lt;/p&gt;
&lt;div class=&quot;highlight-bash&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$ &lt;span class=&quot;nb&quot;&gt;alias&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nixpaste&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;curl -F &amp;#39;text=&amp;lt;-&amp;#39; http://nixpaste.lbr.uno&amp;quot;&lt;/span&gt;
$ &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;|&lt;/span&gt; nixpaste
$ nixpaste &amp;lt; ./myexpr.nix
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id4&quot;&gt;
&lt;h2&gt;Сообщество&lt;/h2&gt;
&lt;p&gt;Перечислю источники по степени активности:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;Форум &lt;a class=&quot;reference external&quot; href=&quot;https://discourse.nixos.org/&quot;&gt;https://discourse.nixos.org/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;&lt;code class=&quot;docutils literal&quot;&gt;&lt;span class=&quot;pre&quot;&gt;#nixos&lt;/span&gt;&lt;/code&gt; irc канал на freenode имеет очень высокую активность,
разработчики &lt;a class=&quot;reference external&quot; href=&quot;https://nixos.org/&quot;&gt;NixOS&lt;/a&gt; и все что с ней связанно в основном общаются здесь.&lt;/p&gt;
&lt;a class=&quot;reference external image-reference&quot; href=&quot;https://webchat.freenode.net/?channels=nixos&quot;&gt;&lt;img alt=&quot;irc freenode&quot; src=&quot;https://img.shields.io/badge/irc-freenode-blue.svg&quot; /&gt;&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;StackOverflow то же весьма активен, много людей из рассылки.&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://stackoverflow.com/questions/tagged/nix&quot;&gt;http://stackoverflow.com/questions/tagged/nix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://stackoverflow.com/questions/tagged/nixos&quot;&gt;http://stackoverflow.com/questions/tagged/nixos&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class=&quot;first&quot;&gt;Рассылки&lt;/p&gt;
&lt;ul class=&quot;simple&quot;&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://twitter.com/nixos_org&quot;&gt;https://twitter.com/nixos_org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://www.reddit.com/r/nixos&quot;&gt;https://www.reddit.com/r/nixos&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://groups.google.com/forum/#!forum/nix-devel&quot;&gt;https://groups.google.com/forum/#!forum/nix-devel&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;id5&quot;&gt;
&lt;h2&gt;Блоги&lt;/h2&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://typing-nix.regnat.ovh/&quot;&gt;https://typing-nix.regnat.ovh/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content>
  </entry>
</feed>
